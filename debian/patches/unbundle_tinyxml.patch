Last-Update: 2012-02-20
Author: Dmitry Smirnov <onlyjob@member.fsf.org>
Forwarded: not-needed
Description: disable building bundled tinyxml
 To use libtinyxml-dev instead


--- a/backend/wbprivate/Makefile.am
+++ b/backend/wbprivate/Makefile.am
@@ -14,7 +14,7 @@
   -I$(top_srcdir)/ext/scintilla/include\
   -I$(top_srcdir)/ext/vsqlite++/include\
   -I$(top_srcdir)/ext/vsqlite\
-  -I$(top_srcdir)/ext/tinyxml
+  @TINYXML_CFLAGS@
 
 libwbprivate_a_SOURCES=\
 	model/canvas_floater.cpp\
@@ -76,11 +76,7 @@
   $(top_srcdir)/frontend/common/grt_python_debugger.cpp\
   $(top_srcdir)/frontend/common/plugin_manager_window.cpp\
   $(top_srcdir)/frontend/common/plugin_install_window.cpp\
-  $(top_srcdir)/frontend/common/select_option_dialog.cpp\
-  $(top_srcdir)/ext/tinyxml/tinyxmlparser.cpp\
-  $(top_srcdir)/ext/tinyxml/tinyxml.cpp\
-  $(top_srcdir)/ext/tinyxml/tinystr.cpp\
-  $(top_srcdir)/ext/tinyxml/tinyxmlerror.cpp
+  $(top_srcdir)/frontend/common/select_option_dialog.cpp
 
 #BUILT_SOURCES=stdafx.h.gch
 #stdafx.h.gch: workbench/stdafx.h
--- a/configure.in
+++ b/configure.in
@@ -101,6 +101,10 @@
     AM_GLIB_GNU_GETTEXT
 fi
 
+PKG_CHECK_MODULES(TINYXML, [tinyxml])
+AC_SUBST(TINYXML_CFLAGS)
+AC_SUBST(TINYXML_LIBS)
+
 have_zip="no"
 if test x"$ac_libzip_libs" = x"no"; then
     PKG_CHECK_MODULES(ZIP, [libzip])
--- a/library/forms/Makefile.am
+++ b/library/forms/Makefile.am
@@ -86,7 +86,7 @@
 -I$(top_srcdir)/ext/vsqlite\
 -I$(top_srcdir)/library/\
 -I$(top_srcdir)/ext\
--I$(top_srcdir)/ext/tinyxml\
+@TINYXML_CFLAGS@\
 -I$(top_srcdir)/ext/scintilla/include
 
 
--- a/modules/wb.mysql.import/Makefile.am
+++ b/modules/wb.mysql.import/Makefile.am
@@ -17,7 +17,7 @@
 	-I$(top_srcdir)/library/sql-parser/source/linux\
 	-I$(top_srcdir)/ext/vsqlite\
 	-I$(top_srcdir)/ext/vsqlite++/include\
-	-I$(top_srcdir)/ext/tinyxml\
+	@TINYXML_CFLAGS@\
 	@MYSQL_INCLUDE@ @GRT_CFLAGS@ @GLIB_CFLAGS@ @SIGC_CFLAGS@
 
 
@@ -26,8 +26,4 @@
 
 wb_mysql_import_grt_la_SOURCES=\
 	src/wb_mysql_import.cpp\
-	src/wb_mysql_import_dbd4.cpp\
-	$(top_srcdir)/ext/tinyxml/tinyxmlparser.cpp\
-	$(top_srcdir)/ext/tinyxml/tinyxml.cpp\
-	$(top_srcdir)/ext/tinyxml/tinystr.cpp\
-	$(top_srcdir)/ext/tinyxml/tinyxmlerror.cpp
+	src/wb_mysql_import_dbd4.cpp
--- a/frontend/linux/workbench/Makefile.am
+++ b/frontend/linux/workbench/Makefile.am
@@ -52,6 +52,7 @@
 	$(top_srcdir)/library/canvas/src/libmdcanvasgtk.la\
 	$(top_srcdir)/library/canvas/src/libmdcanvas.la\
 	@CTEMPLATE_LIBS@\
+	@TINYXML_LIBS@\
 	@GNOME_LIBS@ @GRT_LIBS@ @PCRE_LIBS@ @GLIB_LIBS@ @CAIRO_LIBS@ @ZIP_LIBS@ @MYSQL_LIBS@ @SQLITE3_LIBS@\
 	-lX11
 
